{% extends "./layout/layout.html" %}
{% from "./includes/search_form.html" import search_form %}
{% from "./includes/register_teaser.html" import register_teaser %}
{% from "./includes/pagination.html" import pagination %}

{% block title %}Search results{% endblock %}

{% block body %}

  {% if data.page %}
    {% set page = data.page %}
  {% else %}
    {% set page = 1 %}
  {% endif %}

  <div class="grid-row spacing-top-single">
    <div class="column-two-thirds tablet-column-two-thirds spacing-bottom-single">
      {{ search_form(h1=true,autofocus=false,label='Search results for',value=data.search_term) }}

      {% if results['number_results'] <= 49 %}
        <h2 class="font-xsmall expand-bottom-half">{{ results['number_results'] }} result{% if results['number_results'] > 1 %}s{% endif %} found</h2>
      {% else %}
        <h2 class="font-xsmall expand-bottom-half">Showing first 50 results only</h2>
        <p class="font-small">Land Registry have more than 50 property records for this postcode</p>
      {% endif %}

      <ol class="search-results-listing">
        {% for title in results['titles'] %}
          <li>
            {{ register_teaser(title=title,display_page_number=page,search_term=data.search_term) }}
          </li>
        {% endfor %}
      </ol>

      {% if results['number_pages'] %}
        {{ pagination(page, results['number_pages'],search_term=data.search_term) }}
      {% endif %}
    </div>

    <div class="column-one-third tablet-column-one-third">
      <aside class="supplementary-panel">
        <h2 class="heading-medium">Help finding the right property</h2>
        <!-- <strong class="phase-tag-beta spacing-bottom-half">BETA</strong> -->
        <p>If you're not getting the results you expect please <a rel="external" href="mailto:digital-register-feedback@digital.landregistry.gov.uk">let us know</a></p>
        <p>This new service has a limit of 50 results per postcode</p>
        <p>If you're having trouble finding the property or land you're looking for, try the <a rel="external" href="https://eservices.landregistry.gov.uk/wps/portal/Property_Search">Land Registry 'Find a Property' service</a> instead</p>
      </aside>
    </div>
  </div>
{% endblock %}
