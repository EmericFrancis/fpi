{% extends "./layout/layout.html" %}
{% from "./includes/back_link.html" import back_link %}

{% from "./includes/register_teaser.html" import register_teaser %}

{% block title %}Confirm your purchase{% endblock %}


{% block body %}

  <h1 class="heading-large">Confirm your purchase</h1>

  <!-- prop info row -->
  <div class="grid-row column-flip spacing-top-single">

    <!-- map column -->
    <div class="column-one-third tablet-column-one-third spacing-bottom-single">
      {% if title['indexPolygon'] %}
        <div class="map" id="map">
          <p>Your browser must have JavaScript enabled in order to use the map.
      <li><a href="/drv-18/terms">Terms &amp; Conditions</a></li></p>
        </div>
      {% endif %}
    </div>

    <!-- property information -->
    <div class="column-two-thirds tablet-column-two-thirds">          

      <dl class="definition-tabular definition-tabular-sectioned">

        {% if title.address %}
          <dt class="spacing-bottom-single">Address</dt>
          <dd class="bold-medium spacing-bottom-single">
            <div class="address">
              {% for line in title.address %}
                <span>{{line}}</span>
              {% endfor %}
            </div>
          </dd>
        {% endif %}

        <dt class="spacing-bottom-single">Ownership type</dt>
        <dd class="spacing-bottom-single">
          <strong class="bold">{{ title['tenure'] }}</strong>
        </dd>

        <dt class="spacing-bottom-single">Title number</dt>
        <dd class="bold-small spacing-bottom-single">{{ title['data']['title_number'] }}</dd>

        <dt class="spacing-bottom-single">You'll receive</dt>
        <dd class="spacing-bottom-single">
          <ul class="list-no-bullet">
            <li class="bold-small">Owners' names and addresses</li>
            <li class="bold-small">Details of any mortgages</li>
            <li><span class="bold-small">Price paid</span></li>
            <!-- <li class="bold-small">Title number</li> -->
          </ul>
        </dd>

      </dl>

    </div>

  </div> 


  <!-- pay + help row -->
  <div class="grid-row">

    <div class="column-two-thirds tablet-column-two-thirds">

      <div class="panel panel-simple spacing-top-single">

        <form action="{{path}}/worldpay_1?title_number={{data.title_number}}" method="POST" novalidate data-clientside-validation="pay_form_validation">

          <input name="title_number" value="{{data.title_number}}" type="hidden" />
          <input name="email" value="{{data.email}}" type="hidden" />

          <h2 class="heading-medium spacing-top-third">How to pay</h2>
          <p>This information costs Â£3. Payment will be taken by WorldPay on the Land Registry's behalf.</p>


          <div class="notice">
            <div>
            <i class="icon icon-important">
              <span class="visually-hidden">Warning</span>
            </i>
            </div>
            <div>
                <p style="display:block; padding-left: 65px;margin-left: -15px;"">
                  <span class="bold-small">Important: make sure this is the property you want.</span><br>You can't cancel once you've paid and the information is displayed.
                </p>
            </div> 
           
          </div>

          <div class="form-group spacing-top-single">
            <label class="block-label" for="terms">
              <input id="terms" name="terms" type="checkbox" value="terms">
              I have read and agree to the <a href="terms_and_conditions#contract">terms of use</a>
            </label>
          </div>

          <input type="submit" class="button" value="Pay now">
          <!-- <input type="submit" id="payNow" class="button" value="Pay now" disabled> -->

        </form>

        <p class="spacing-top-single">
          <a href="search_results">Cancel and return to search results</a>
        </p>

      </div>

    </div>

    <div class="column-one-third tablet-column-one-third">
      <aside class="supplementary-panel">
        <h2 class="heading-medium">Need help with this service?</h2>
        <p>Call Land Registry on 0300 006 0411 to report a problem, or if you're stuck and need help.</p>
      </aside>
    </div>

  </div>





        <script type="application/json" id="pay_form_validation">
        {
          "terms": {
            "presence": {
              "message": "You must agree to the terms of use before continuing"
            }
          }
        }
      </script>


<!--   <script>
    (function() {
      var terms = document.getElementById('terms');

      var payButton = document.getElementById('payNow');

      function change(e) {

            if((terms.checked) == true) {
                payButton.disabled = false;
            } else {
                payButton.disabled = true;
            };

      }
      terms.addEventListener('change', change);
    })();
  </script> -->


  {% if title['indexPolygon'] %}
    <script>
      var indexData = {{ title['indexPolygon'] | json | safe }};
    </script>
    <script defer src="{{ asset_path }}app/javascripts/map.js"></script>
  {% endif %}
{% endblock %}
